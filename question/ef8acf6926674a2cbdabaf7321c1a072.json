[
  "[File: stackslib/src/net/atlas/db.rs] [Function: instantiate()] [Schema Injection] Could an attacker craft malicious genesis_attachments that inject SQL into the batch execution during schema initialization, bypassing parameterized query protection? (Critical)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: instantiate()] [Data Corruption] If genesis_attachments contains duplicate hashes, will INSERT OR REPLACE silently overwrite attachments without warning, potentially causing consensus divergence if nodes receive different genesis sets? (Critical)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: instantiate()] [Resource Exhaustion] Can an attacker provide an unbounded genesis_attachments vector that exhausts memory or disk space during database instantiation before size limits are enforced? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: instantiate()] [Time Manipulation] Could manipulating the system clock cause util::get_epoch_time_secs() to return invalid timestamps that break expiration logic or create ordering inconsistencies? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: apply_schema_2()] [Migration Race] If apply_schema_2() is called concurrently on the same database connection, could the ALTER TABLE and UPDATE statements create inconsistent state or corrupt existing data? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: apply_schema_2()] [Incomplete Migration] The UPDATE sets status = 2 for all rows, but if the ALTER TABLE fails partially, could some instances have NULL status while others have status = 2, breaking status-based queries? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: check_schema_version_and_update()] [Panic on Invalid Version] If the schema version is neither '1' nor '2', the function panics instead of returning an error - could this be exploited to DoS a node by corrupting the db_config table? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: check_schema_version_or_error()] [Integer Parsing Panic] The function calls .parse().expect() on the version string without validation - could a non-integer version string in db_config crash the node? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: get_schema_version()] [MAX Ambiguity] Using MAX(version) assumes versions are comparable - if multiple version strings exist (e.g., '2' and '10'), could lexicographic comparison return '2' instead of '10', causing incorrect schema detection? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: connect()] [TOCTOU Race] The fs::metadata check and subsequent file opening create a time-of-check-time-of-use race - could an attacker delete/replace the database file between these operations? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: add_indexes()] [Index Creation Failure] If index creation fails partway through ATLASDB_INDEXES array, could the database be left in an inconsistent state with some indexes present and others missing, degrading performance unpredictably? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: instantiate()] [Transaction Rollback] If the transaction commits successfully but add_indexes() fails afterward, are the schema and genesis attachments persisted without indexes, potentially causing severe performance degradation? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: check_instantiate_db()] [Schema Check Bypass] If create_flag is false but the database is corrupted or has an invalid schema, does the function skip instantiate() and only run check_schema_version_and_update(), potentially leaving the database unusable? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [ATLASDB_SCHEMA_2] [Null Status Handling] The comment states status is nullable because SQLite won't allow NOT NULL without a default, but the code UPDATE sets status = 2 - can new insertions after migration create NULL status values that break status-based queries? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [ATLASDB_INITIAL_SCHEMA] [Primary Key Collision] The attachment_instances PRIMARY KEY is (index_block_hash, contract_id, attachment_index) - could an attacker craft transactions that collide on this key to overwrite legitimate instances via INSERT OR REPLACE? (Critical)",
  "[File: stackslib/src/net/atlas/db.rs] [Schema Constants] [Integer Type Mismatch] The schema uses INTEGER for block_height, created_at, and status, but Rust code casts u64 block heights to i64 - could block heights above i64::MAX cause overflow or be silently truncated? (Critical)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: connect()] [Readwrite Flag Inconsistency] If readwrite is false but create_flag is somehow true, does check_instantiate_db handle this inconsistency correctly or could it attempt write operations on a read-only connection? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: insert_uninstantiated_attachment()] [Race Condition] The count check and eviction happen outside the transaction that inserts the attachment - could concurrent inserts bypass max_uninstantiated_attachments limit if they all check count before any eviction occurs? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: insert_uninstantiated_attachment()] [Arithmetic Overflow] The calculation '1 + uninstantiated_attachments - max_uninstantiated_attachments' could underflow if uninstantiated_attachments < max_uninstantiated_attachments - 1, causing massive eviction? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: insert_uninstantiated_attachment()] [INSERT OR REPLACE Semantics] Using INSERT OR REPLACE on an existing hash updates created_at timestamp - could an attacker continuously re-insert the same attachment to prevent it from being evicted by age? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: evict_k_oldest_uninstantiated_attachments()] [Subquery Ordering] The subquery orders by created_at ASC without tiebreaker - if multiple attachments have identical timestamps, which ones are evicted is non-deterministic, potentially causing consensus divergence? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: evict_k_oldest_uninstantiated_attachments()] [Type Cast Overflow] The parameter k is u32 but SQL LIMIT accepts i64 - could passing u32::MAX cause integer overflow or unexpected behavior in the LIMIT clause? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: evict_expired_uninstantiated_attachments()] [Timestamp Overflow] The calculation 'now - uninstantiated_attachments_expire_after as i64' could overflow if expire_after is very large, causing cut_off to wrap and delete all or no attachments? (High)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: evict_expired_uninstantiated_attachments()] [Clock Skew] If the system clock is set backward after attachments are created, created_at timestamps could be in the future, preventing expiration forever? (Medium)",
  "[File: stackslib/src/net/atlas/db.rs] [Function: insert_instantiated_attachment()] [Status Filter Missing] The UPDATE statement for is_available filters by status = Checked, but what happens to Queued instances with the same content_hash - do they remain unavailable even though the attachment now exists? (High)"
]