[
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Nested Loop Termination] The inner loop (line 583) checks keep_running - if shutdown is signaled during burnchain sync, can the break on line 585 exit cleanly without corrupting state? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Poll Time Manipulation] poll_time_secs on line 592 is read from config - if set to 0, will this cause infinite tight polling and CPU exhaustion? If set to u64::MAX, will nodes never poll? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Epoch Time Overflow] get_epoch_time_secs() + poll_time_secs on line 592 - if this addition overflows, will poll_deadline wrap around to a small value, causing immediate re-polling? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Burnchain Sync Error] burnchain.sync on line 595 can return Err - the continue on line 599 skips updating burnchain_tip - can repeated errors cause the node to loop forever with stale tip data? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Tip Update Race] burnchain_tip and burnchain_height are updated on lines 604-605 - if another thread reads these mid-update, can it see inconsistent height vs. snapshot data? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - inner loop] [Sortition Height Comparison] The comparison next_sortition_height != last_tenure_sortition_height on line 610 logs info - but if sortition_db_height isn't updated yet, can this cause confusing log spam? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Height Gap Vulnerability] The condition next_sortition_height > sortition_db_height on line 616 processes all blocks in between - if there's a large gap, can processing thousands of blocks without checkpoints cause memory exhaustion? (High)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Mining Block Race] signal_mining_blocked on line 624 blocks mining - if a sortition occurs between this signal and processing completes, can the miner miss a sortition opportunity? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Range Off-by-One] The range (sortition_db_height + 1)..(next_sortition_height + 1) on line 627 is inclusive on the right - is this correct, or can it process next_sortition_height twice if the loop runs again? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Ancestor Query Failure] get_ancestor_snapshot on line 634 with unwrap and expect - if the snapshot doesn't exist, will this panic, and can an attacker cause this by manipulating sortition_tip? (High)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Sort Count Accuracy] sort_count is incremented only if block.sortition is true on lines 640-642 - if the sortition field is incorrectly set in the snapshot, can this cause incorrect metrics? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Process Burnchain Error] If process_burnchain_state on line 647 returns Err, the function returns immediately on line 655 - can this leave the node in a partially-processed state with some sortitions applied but not others? (Critical)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Mining Ready Race] signal_mining_ready on line 660 re-enables mining - if this is called before all sortitions are committed to the chainstate DB, can mining start with incomplete state? (High)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Sortition Count Mismatch] num_sortitions_in_last_cycle on line 662 stores sort_count - if this doesn't match the expected number of sortitions per cycle, can this indicate a consensus bug that should halt the node? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - sortition processing] [Height Update Atomicity] sortition_db_height is updated to next_sortition_height on line 667 - if the node crashes between processing sortitions and this update, can it reprocess the same sortitions on restart? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - IBD block processing] [IBD Announcement] The else if ibd block on line 668 calls announce_new_stacks_block - but ibd is hardcoded to false, so this is dead code. If IBD logic is added later, can stale blocks be announced prematurely? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - target advancement] [Target Height Stall] The break on line 679 exits when burnchain_height >= target or remote_chain_height - if target and remote are both higher than burnchain_height but sync is stalled, can the loop exit prematurely? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - reward cycle advancement] [Next Target Calculation] next_target_burnchain_block_height on lines 686-694 calculates the next reward cycle boundary - if reward_cycle_to_block_height returns a value <= current target due to calculation error, can this cause an infinite loop? (Critical)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - reward cycle advancement] [Expect on Reward Cycle] The expect 'burnchain height before system start' on line 690 - if somehow the target is before first block, will this panic? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - reward cycle advancement] [Target Update Race] target_burnchain_block_height is updated on line 697 - if another thread reads this between calculation and assignment, can it see a stale target and make wrong decisions? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - mining eligibility] [Canonical Tip Query] get_canonical_burn_chain_tip on line 701 can return different tips on different nodes due to timing - can this cause some nodes to start mining while others don't, fragmenting the miner set? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - mining eligibility] [Stacks Tip Unavailable] If canonical_burn_chain_tip fails on line 702, unwrap_or(0) returns 0 - will this cause the mine_start check on line 704 to incorrectly pass and allow premature mining? (High)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - mining eligibility] [Mine Start Reset] mine_start is set to 0 on line 711 after first sync - the comment says this prevents corner cases in PoX forks. Can an attacker intentionally trigger PoX forks to manipulate when mining starts? (Medium)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - mining eligibility] [Tenure Height Tracking] last_tenure_sortition_height is updated only if different from sortition_db_height on line 714 - if they're equal due to no sortitions, is the info logging on lines 716-723 skipped forever? (Low)",
  "[File: stacks-core/stacks-node/src/run_loop/nakamoto.rs] [Function: start() - mining eligibility] [Initiative Raise] globals.raise_initiative on line 725 signals 'runloop-synced' - if multiple nodes raise this simultaneously, can this cause thundering herd problems in downstream systems waiting for this signal? (Low)"
]