[
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpResponse::new_error()] [Error Payload Leakage] If error.payload() returns detailed internal state, can this leak sensitive information (e.g., database paths, internal IPs, stack traces) to attackers via error responses? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpResponse::new_error_with_headers()] [Header Injection] If extra_headers contains attacker-controlled data (e.g., from Referer or User-Agent), can newlines in values enable header injection or response splitting attacks? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpResponse::send()] [Chunked Encoding Decision] If content_length is None, it uses send_chunked(). Can an attacker force chunked encoding by omitting Content-Length to trigger different code paths with potential vulnerabilities? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpResponse::get_http_payload_ok()] [Status Code Logic] Returns NotFoundError for 404, RecvError for other non-200 codes. Can 3xx redirects or 1xx informational codes bypass this logic and be incorrectly treated as success? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::new()] [Max Size Validation] The max_size parameter is passed to HttpChunkedTransferReaderState. Can an attacker provide max_size=0 or u64::MAX to cause arithmetic overflow in chunk size calculations or disable size limits? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [Buffer Growth] As decoded chunks are appended to self.data via extend_from_slice(), can an attacker send many small chunks to cause unbounded memory growth exceeding max_size due to incremental allocation? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [Chunk Boundary Confusion] If do_read() returns (0, num_consumed) with num_consumed > 0, does this indicate partially consumed chunk encoding that isn't decoded yet? Can malformed chunk boundaries cause state.is_eof() to never return true? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [Error Recovery] If do_read() returns Err(e), and e.kind() is neither WouldBlock nor TimedOut, it returns NetError::ReadError(e). Does this properly reset stream state, or can subsequent reads continue from corrupted state? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [Total Consumed Tracking] The total_consumed counter is incremented without overflow checks. Can extremely long responses cause total_consumed to wrap around, leading to incorrect byte counts returned to caller? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [EOF Detection] When state.is_eof() is true, the function resets state and returns Some((message_data, total_consumed)). Can an attacker craft chunked encoding with multiple EOF markers (e.g., \\",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttpRecvStream::consume_data()] [Buffer Slice Safety] Uses decoded_buf.get(0..read_pass). If read_pass > CHUNK_BUF_LEN, does get() return None correctly, or can buffer overruns occur if do_read() returns incorrect read_pass values? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::new()] [Handler Registration Race] Calls register_rpc_methods() which registers all handlers. If this is called multiple times or from multiple threads, can duplicate handlers be registered, leading to route ambiguity? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::new_client()] [Arbitrary Response Risk] Sets allow_arbitrary_response=true. Does this skip security validations that should apply even to client responses, like signature checks or message origin verification? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::register_rpc_endpoint()] [Regex Compilation] If handler.path_regex() or make_permissive_regex() contains an invalid pattern, does register_rpc_endpoint panic or fail gracefully? Can this be exploited to crash the node during handler registration? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::register_rpc_endpoint()] [Handler Overwrite] If multiple handlers with identical (verb, path_regex) pairs are registered, does the last one win? Can this lead to API endpoint shadowing where an attacker-influenced handler overrides a legitimate one? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::set_pending()] [Request ID Override] Sets reply.request_id from preamble.get_request_id() with fallback to HTTP_REQUEST_ID_RESERVED. Can an attacker send a response with request_id=0 to match a non-existent request, causing request/response mismatch? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::set_preamble()] [Response Without Request] Checks if request_handler_index.is_none() && !allow_arbitrary_response and returns DeserializeError. Can an attacker race a response to arrive before request_handler_index is set, bypassing this check? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::set_preamble()] [Duplicate Reply] If reply.is_some() when set_pending() is called, it returns InProgress. Can an attacker send duplicate response preambles to cause InProgress errors, denying service to legitimate requests? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::reset()] [Incomplete Reset] Resets request_handler_index and reply to None. Are there other state fields (e.g., body_start, num_preamble_bytes) that should be reset but aren't, leading to state leakage across requests? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::consume_data()] [State Validation] Checks if !preamble.is_chunked() and returns InvalidState. Can an attacker send a non-chunked response but then stream data, causing this check to fail and reset state via reset()? (Low)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::consume_data()] [Reply Mutation] Calls reply.stream.consume_data() with &mut fd. If this fails with inspect_err(), it calls reset(). Can partial state mutations in stream persist if reset() doesn't fully clean up? (Medium)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::body_start_search_window()] [Index Bounds] Uses buf[0], buf[1], buf[2], buf[i-4], etc. without bounds checks (has #[allow(clippy::indexing_slicing)]). If i or buf.len() values are attacker-controlled, can out-of-bounds reads occur? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::body_start_search_window()] [Window Alignment] For i=0..3, it combines last_four_preamble_bytes with buf. If buf.len() < i, does accessing buf[0..i] panic? Can attackers send short buffers to trigger panics? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::read_preamble()] [Loop Bounds] Loops 'for i in 0..=buf.len()'. When i==buf.len(), body_start_search_window(i, buf) accesses buf[i-4..i]. If buf.len() < 4, can this cause underflow or invalid window? (High)",
  "[File: stackslib/src/net/httpcore.rs] [Function: StacksHttp::read_preamble()] [Body Start Detection] If the sequence '\\\\r\\\\n\\\\r\\\\n' appears twice in buf, does the loop find the first occurrence? Can attackers inject fake headers to cause premature body_start detection and truncated preamble parsing? (High)"
]