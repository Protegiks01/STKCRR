[
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [IPv4 Special Addresses] When converting to IPv4 at line 63-64, are reserved IPv4 ranges (127.0.0.0/8, 0.0.0.0/8, 224.0.0.0/4) validated, or could an attacker advertise loopback/broadcast addresses? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: new()] [Address Validation] Does new() at lines 41-51 validate that the input SocketAddr is routable and non-reserved before creating an Address, or could nodes advertise unreachable addresses that fragment the P2P network? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [Flow Info Loss] When creating SocketAddrV6 at line 66, flow info and scope_id are hardcoded to 0 - could this cause IPv6 link-local addresses to be unroutable and partition the network? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Constant: ONION] [Tor V2/V3 Confusion] Does the ONION prefix at line 37 correctly distinguish between Tor v2 and v3 addresses, or could v2 addresses bypass detection now that Tor v2 is deprecated? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: consensus_decode()] [Resource Exhaustion] Could an attacker send a rapid stream of Address messages that fail to decode but consume significant CPU in the repeated ? error propagation at lines 97-99? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [TOCTOU] If socket_addr() is called multiple times on the same Address, could the Tor check result at line 57 differ between calls if the ONION constant is modified by another thread (though it's not mutable)? (High)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [Conversion Loss] Does the SocketAddrV6::new() call at line 66 with hardcoded 0 for flow_info and scope_id cause loss of routing information that could break IPv6 connectivity? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: new()] [Port Validation] Does new() at lines 41-51 validate that the port is within the valid range (1-65535) before storing it, or could port 0 (reserved) be accepted? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Struct: Address] [Field Visibility] All fields (services, address, port) are public at lines 29-34 - could external code modify these fields after creation, breaking invariants expected by consensus code? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: clone()] [Unnecessary Allocation] Does the manual clone implementation at lines 119-123 perform unnecessary allocations compared to a derived Copy implementation, given that Address is a fixed-size struct? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: PartialEq::eq()] [Comparison Optimization] Could the PartialEq implementation at lines 128-132 benefit from comparing port first (likely to differ) before services and address for better branch prediction? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: fmt()] [Debug Output] Does the Debug implementation at lines 105-113 handle the case where address segments contain non-printable values that could break log parsers or terminal output? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: addr_to_be()] [Optimization] The addr_to_be() function creates a new array at lines 72-81 - could this allocation in the encoding hot path cause performance issues when serializing large peer lists? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: consensus_encode()] [Error Context] If consensus_encode() fails, does the serialize::Error provide enough context to identify which network peer sent the malformed address for banning/rate-limiting? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [IPv6 Scoped Addresses] For IPv6 link-local addresses (fe80::/10), does hardcoding scope_id to 0 at line 66 prevent connections on multi-homed hosts with multiple network interfaces? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: new()] [IPv6 Zone ID Loss] When converting SocketAddr to Address at lines 42-45, is the IPv6 zone ID/scope_id preserved, or does this information get lost and prevent reconnection to link-local peers? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: socket_addr()] [IPv4-Mapped Edge Case] If an address is IPv4-mapped but the IPv4 portion contains :: compression, could to_ipv4() at line 63 return Some for an invalid mapping? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: consensus_decode()] [Truncated Data] If the input stream ends prematurely while decoding the address array at line 98, does the error clearly indicate truncation vs corruption? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Constant: ONION] [Array Indexing] The ONION check at line 57 compares addr[0..3] - is there a bounds check that prevents panic if addr is somehow shorter than 8 elements (though the type guarantees this)? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: new()] [Match Arm Consistency] Do both match arms at lines 42-44 handle socket addresses consistently, or could differences in how V4 vs V6 addresses are stored cause subtle bugs? (Medium)",
  "[File: stacks-core/stacks-common/src/deps_common/bitcoin/network/address.rs] [Function: addr_to_be()] [Array Construction] Does the array construction at lines 72-81 guarantee that all 8 elements are initialized, or could partial initialization cause undefined behavior? (Medium)"
]