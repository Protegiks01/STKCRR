[
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Sorting Stability] If `sort_unstable_by` at line 198 changes the order of equal elements non-deterministically, can this cause different nodes to prune different peers, leading to network partitioning? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Early Break Exploit] The break condition at line 238 checks `num_outbound - (ret.len() as u64) <= soft_num_neighbors` - can an attacker exploit integer edge cases to prevent proper pruning? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Weighted Sampling Manipulation] At line 267-272, empty neighbor_info entries are excluded from `weighted_sample` - can an attacker race to empty their org's neighbor list to avoid sampling? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Infinite Loop Risk] The while loop at line 266 could theoretically run forever if pruning doesn't reduce `ret.len()` - what prevents this from becoming a DoS vector? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Remove Operation Cost] Calling `neighbor_info.remove(0)` at lines 242 and 294 has O(n) cost for vectors - can repeated removals during pruning cause quadratic complexity and DoS? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Cast Overflow] Multiple casts from usize to u64 (e.g., line 211, 235, 266) - can overflow on 32-bit systems cause incorrect pruning logic or infinite loops? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Option Handling] The `Some((neighbor_key, _)) = neighbor_info.first().cloned()` pattern at line 285 uses continue if None - can this skip pruning certain orgs indefinitely? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_outbound_orgs()] [Soft Limit Inconsistency] Two different DropReasons are used (OrgDominatesPeerTable vs OrgTooManyMembers) - can nodes disagree on which peers to ban if they have different connection limits? (Low)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [Connection Counting] At line 313, `num_inbound` is calculated as `self.num_peers() - count_outbound_conversations()` - can race conditions cause negative values or incorrect counts? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [IP Spoofing] Can an attacker spoof source IP addresses to bypass per-IP connection limits by appearing to come from different IPs? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [Preserve Set Abuse] If all inbound connections from an IP are in the `preserve` set, can that IP establish unlimited connections without being pruned? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [HashMap Growth] The `ip_neighbor` HashMap at line 319 can grow to the size of all inbound peers - can an attacker with many IPs cause memory exhaustion before pruning takes effect? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [Sorting by Time] Peers are sorted by `first_contact_time` at line 340 - can an attacker manipulate connection timing to ensure their newest peers are kept while older ones are pruned? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [Skip Behavior] The function uses `skip` at line 357 to remove excess connections - can off-by-one errors cause one fewer or one more connection to be removed than intended? (Low)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [Cast Safety] Casting `neighbor_info.len()` to u64 at line 353 - can this overflow on 32-bit platforms causing incorrect comparison with `soft_max_clients_per_host`? (Low)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [IPv6 vs IPv4] Does `PeerAddress` distinguish between IPv4 and IPv6, and can an attacker use both address families from the same host to double their connection limit? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier_inbound_ip()] [No DropReason] Unlike outbound pruning, inbound pruning returns `Vec<NeighborKey>` without DropReason - can this cause inconsistent banning or metrics? (Low)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Counting Consistency] At line 394, `num_inbound` uses `saturating_sub(num_outbound)` - can saturation hide bugs where outbound count exceeds total peer count? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Order Dependency] Inbound pruning happens before outbound pruning (lines 400, 424) - can this ordering be exploited to maintain more connections than limits allow? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Deregister Consistency] When calling `deregister_neighbor` at lines 414 and 440, can race conditions cause the peer to be deregistered twice, leading to incorrect counts? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Prune Count State] The `prune_inbound_counts` and `prune_outbound_counts` HashMaps track how many times each peer is pruned - can these counters overflow and wrap to 0? (Low)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Error Handling] If `prune_frontier_outbound_orgs` returns an error (propagated from DB), it's converted to empty vec with `unwrap_or_default()` at line 426 - can DB errors prevent outbound pruning indefinitely? (High)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Counter Insertion Race] At lines 416-421 and 442-447, the counter insertion checks `contains_key` then inserts - can concurrent calls lead to race conditions in counter updates? (Medium)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [Preserve Set Size] There's no limit on the size of the `preserve` set - can an attacker add all peers to it externally to completely disable pruning? (Critical)",
  "[File: stacks-core/stackslib/src/net/prune.rs] [Function: prune_frontier()] [DropSource Inconsistency] All deregistrations use `DropSource::PeerNetwork` - can this cause issues if the source should vary based on the drop reason? (Low)"
]