[
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockRequestKey::new()] [Integer Overflow] Can sortition_height or canonical_stacks_tip_height overflow when passed as u64 parameters, causing incorrect block request tracking or priority calculations? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockRequestKey::new()] [Consensus Divergence] If the same consensus_hash is paired with different anchor_block_hash values in concurrent requests, could this cause nodes to download and accept conflicting blocks for the same sortition? (Critical)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockRequestKey::new()] [Time Manipulation] Can an attacker manipulate system time via get_epoch_time_secs() at line 105 to bypass download_start tracking and cause incorrect timeout calculations? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: make_getblock_request()] [Path Traversal] Can the index_block_hash at line 116 contain special characters that enable path traversal in the HTTP GET request format string? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: make_confirmed_microblocks_request()] [Path Traversal] Can the index_block_hash at line 127 be manipulated to access unintended microblock streams through the URL path? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockDownloader::new()] [Resource Exhaustion] Can max_inflight_requests be set to u64::MAX causing memory exhaustion when allocating HashMap entries for blocks_to_try and microblocks_to_try? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockDownloader::reset()] [State Inconsistency] The reset() method at lines 276-296 clears request maps but preserves sortition heights and download accounting - can this cause requests to be retried with stale height information after a PoX reorg? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockDownloader::reset()] [Memory Leak] Does clearing getblock_requests and getmicroblocks_requests at lines 283-284 properly release HTTP conversation handles, or can this leak connection resources? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockDownloader::restart_scan()] [Integer Underflow] Can sortition_start at line 300 be 0, causing saturating_sub to underflow when calculating next sortition heights, potentially skipping blocks? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: BlockDownloader::restart_scan()] [State Corruption] If restart_scan is called while downloads are in-flight, can it cause block_sortition_height and next_block_sortition_height at lines 300-303 to become inconsistent with pending requests? (Critical)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [DNS Cache Poisoning] Can an attacker provide malicious URLs that resolve to attacker-controlled IPs, causing the downloader to connect to fake nodes and download invalid blocks? (Critical)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [State Assertion Failure] If dns_lookups_begin is called when state is not DNSLookupBegin (line 314), the assert_eq will panic - can an attacker trigger this by manipulating state transitions? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [PoX Reorg Race] The pox_id is captured at line 317 - if a PoX reorg occurs during DNS lookups, can this cause blocks to be downloaded under the wrong PoX context? (Critical)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [URL Parsing Bypass] Can an empty url_str at line 320 bypass validation but still be inserted into dns_lookups, causing issues in later processing? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [Timeout Overflow] Can dns_timeout at line 336 overflow when added to get_epoch_time_ms(), causing immediate or incorrect timeout? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_begin()] [IPv6 Bypass] For IPv6 addresses at line 349, can an attacker specify link-local or multicast addresses to bypass network isolation? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_try_finish()] [Infinite Loop] If dns_client.poll_lookup never returns Ok(Some) for certain requests, can inflight remain non-zero indefinitely at line 394, blocking the downloader? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: dns_lookups_try_finish()] [DNS Result Validation] When DNS results are stored at line 377, is there validation that returned addresses are routable and not in reserved ranges? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [State Assertion Failure] Can the assert_eq at line 415 panic if state transitions occur unexpectedly, causing node crash? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [Block Hash Validation Bypass] At lines 478-481, if StacksBlockHeader::make_index_block_hash returns a different hash than expected, the block is rejected - but can an attacker send a valid block with an incorrect consensus_hash to cause DoS? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [Peer Reputation Manipulation] When a peer returns an invalid block at line 484, it's marked as broken - can an attacker frame honest peers by intercepting responses and replacing valid blocks with invalid ones? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [NotFoundError Handling] At line 503, a NotFoundError causes the peer to be marked broken because the block inv indicated the block was present - can this be exploited if inventory state becomes stale? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [Request Cleanup Race] When requested_blocks.remove is called at line 437, can concurrent hint_block_sortition_height_available calls cause the same block to be re-requested immediately? (Medium)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [Always-Allowed Peer Bypass] At lines 439-465, always-allowed peers skip URL blocking - can malicious always-allowed peers DoS the downloader by never responding? (High)",
  "[File: stackslib/src/net/download/epoch2x.rs] [Function: getblocks_try_finish()] [URL Blocking Overflow] When blocked_urls is inserted at line 453 with get_epoch_time_secs() + BLOCK_DOWNLOAD_BAN_URL, can time rollback cause permanent blocking? (Medium)"
]